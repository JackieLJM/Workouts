<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        div {
            font-size: 40px;
        }
    </style>
</head>

<body>
    <div id="time"></div>
    <form name="my">
        <div id="inputArea">
            <p>请依次输入国家法定节假日的放假日:</p>
            <div id="festival"></div>
            <input id="input" type="text" name="text" maxlength="7" value="a">
            <input id="submit" type="submit" value="存储当前日期">
            <div id="nownow"></div>
            <div id="myBtn">button</div>
            <div id="demo"></div>
            <p>距离国庆节剩余时间：</p>
            <div id="left"></div>
        </div>
        <div id="header"></div>
    </form>
    <script>
        // 获取表单子元素的值
        console.log(typeof my.text.value);
        // 用对象存储一组键值对，该对象是一个JSON对象
        var holidays = {
            "zh": [{
                "New Year's Day": "元旦节"
            }, {
                "the Spring Festival": "春节"
            }, {
                "qing Ming Festival": "清明节"
            }, {
                "Internatinal Labour Festival": "劳动节"
            }, {
                "the Dragon-Boat Festival": "端午节"
            }, {
                "the Mid-Autumn Festival": "中秋节"
            }, {
                "National Day": "国庆节"
            }],
            "2017": [{
                0: "1 1"
            }, {
                1: "1 27"
            }, {
                2: "4 2"
            }, {
                3: "5 1"
            }, {
                4: "5 28"
            }, {
                5: "10 1"
            }, {
                6: "10 1"
            }]
        }
        console.log(Object.keys(holidays["2017"][1]));
        console.log(holidays["2017"]);
        for (var i = 0; i < 7; i++) {
            (function () {
                holidays["2018"] = [];
                holidays["2018"].push({
                    "New Year's Day": "1 1"
                });
                holidays["2018"].length = 7;
            })();
        }
        console.log(holidays);
        console.log(holidays["2018"][1]);
        console.log(Object.values(holidays["2017"][1])[0].split(" ")[0]);
        console.log(Object.values(holidays["2017"][1])[0].split(" ")[1]);
        // 用数组存储键值对
        var holiday = [{
            "New Year's Day": "1 1"
        }, {
            "the Spring Festival": "1 27"
        }, {
            "qing Ming Festival": "4 2"
        }, {
            "Internatinal Labour Festival": "5 1"
        }, {
            "the Dragon-Boat Festival": "5 28"
        }, {
            "the Mid-Autumn Festival": "10 1"
        }, {
            "National Day": "10 1"
        }]

        var holidayzh = [{
            "New Year's Day": "元旦节"
        }, {
            "the Spring Festival": "春节"
        }, {
            "qing Ming Festival": "清明节"
        }, {
            "Internatinal Labour Festival": "劳动节"
        }, {
            "the Dragon-Boat Festival": "端午节"
        }, {
            "the Mid-Autumn Festival": "中秋节"
        }, {
            "National Day": "国庆节"
        }]
        var monthDays = {
            1: 31,
        }
        console.log(Object.keys(holiday[1]));
        console.log(Object.values(holiday[1])[0].split(" ")[0]);
        console.log(Object.values(holiday[1])[0].split(" ")[1]);
        // 计算当前时间距离下一个节假日算法
        (function cal() {
            // 声明初始变量
            var now = new Date();
            var year = now.getFullYear();
            var month = now.getMonth() + 1;
            var day = now.getDate();
            var minutes = now.getMinutes();
            var seconds = now.getSeconds();
            var hours = now.getHours();
            var one = 0;
            var endMonth = 10;
            var endDay = 1;
            // 计算剩余天数
            for (var startMonth = month; startMonth < endMonth; startMonth++) {
                var days = 0;
                if (startMonth === 1 || startMonth === 3 || startMonth === 5 || startMonth === 7 || startMonth === 8 || startMonth === 10 || startMonth === 12) {
                    days = 31;
                }
                else if (startMonth === 4 || startMonth === 6 || startMonth === 9 || startMonth === 11) {
                    days = 30;
                }
                else if ((year % 4 === 0 && year % 400 === 0) && startMonth === 2) {
                    days = 29;
                }
                else if (((year % 4 === 0 && year % 400 === 0) === false) && startMonth === 2) {
                    days = 28;
                }
                one = one + days;
            }
            one = one + endDay - 1 - day;
            var leftHours = 24 - hours - 1;
            var leftMinutes = 60 - minutes - 1;
            var leftSeconds = 60 - seconds;
            setInterval(function () {
                if (leftSeconds === 0) {
                    leftSeconds = 60;
                    if (leftMinutes === 0) {
                        leftMinutes = 60;
                        if (leftHours === 0) {
                            leftHours = 24;
                            one - 1;
                        }
                        leftHours = leftHours - 1;
                    }
                    leftMinutes = leftMinutes - 1;
                }
                leftSeconds = leftSeconds - 1;
                // console.log(leftSeconds);
                document.getElementById("left").innerHTML = one + "天" + leftHours + "小时" + leftMinutes + "分钟" + leftSeconds + "秒";
            }, 1000);
        })();
        // 输入本年份的节假日日期存储到holidays对象里

        (function store() {
            var year = 2018;
            var festival = document.getElementById("festival");
            var submit = document.getElementById("submit");
            var input = document.getElementById("input");
            var nownow = document.getElementById("nownow");
            if (year == 2017) {
                document.getElementById("inputArea").style.display = "none";
            } else {
                var promise = new Promise(function (resolve, reject) { resolve(3); });
                document.createDocumentFragment;
                submit.addEventListener("click", function (event) {
                    event.preventDefault();
                    console.log(typeof input.value);
                    console.log(Object.getOwnPropertyNames(holidays));
                    console.log(holidays["2017"][0][0] = input.value);
                    console.log(holidays["2017"][0]);
                    nownow.innerHTML = (Object.values(holidays["2017"][0])[0].split(" ")[0] + "月" + Object.values(holidays["2017"][0])[0].split(" ")[1] + "号");
                });
                Object.values(holidays["2017"][0])[0];
                console.log(new Promise(function (resolve, reject) { reject(3); }).then(null, function (error) { console.log(error); }));
                console.log(promise.then(function (value) { return value * 2; }).then(function (value) { console.log(value); }));
                console.log(new Promise(function (resolve, reject) {
                    console.log(this);
                    submit.onclick = function (event) {
                        console.log(event.target.nodeName);
                    }
                    resolve(3);
                }).then(function (value) { console.log(Object.values(holidays["zh"][value])[0]) }));

                console.log(input.value === "");

            }
        })();

        // document.getElementById("myBtn").addEventListener("click", function () {
        //     document.getElementById("demo").innerHTML = "Hello World";
        // });
        // 当前时间自动运转
        setInterval(function () {
            var date = new Date();
            var dates = date.toString();
            document.getElementById("time").innerHTML = dates;
        }, 1000);


        // setTimeout返回值示例
        function changeHeaderDeferred() {
            var header = document.getElementById("header");

            setTimeout(function changeHeader() {
                header.style.color = "red";

                return false;
            }, 100);

            return false;
        }
        changeHeaderDeferred();

        // 异步任务同步任务打印结果示例
        (function test() {
            setTimeout(function () { console.log(4) }, 0);
            new Promise(function executor(resolve) {
                console.log(1);
                for (var i = 0; i < 10000; i++) {
                    i == 9999 && resolve();
                }
                console.log(2);
            }).then(function () {
                console.log(5);
            });

            new Promise(function executor(resolve) {
                console.log(6);
                for (var i = 0; i < 10000; i++) {
                    i == 9999 && resolve();
                }
                console.log(7);
            }).then(function () {
                console.log(8);
            });
            console.log(3);
        })()
    </script>
</body>

</html>